<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">

		<title>Genuary22 | 21 - Combine two (or more) of your pieces from previous days to make a new piece</title>

		<script src="../p5.js"></script>
	</head>

	<style>
		body {
			padding: 0;
			margin: 0;
			position: fixed;
			top: 0; left: 0; right: 0; bottom: 0;
			border: none;
			overflow: hidden;
		}
	</style>

	<body></body>

	<script>
		const MODE_DEBUG = false;
		const brushes = [];

		function setup() {
			createCanvas(window.innerWidth, window.innerHeight);
			frameRate(48);
			setStyle();
			loadBrushes(floor(width * .1));
		}

		function draw() {
			brushes.forEach(b => {
				b.update();
				b.checkMargin();
				b.display();
			});
		}

		function setStyle() {
			background(12);
			colorMode(HSL);
			noFill();
			stroke(0, 60, 60);
			angleMode(RADIANS);
			strokeWeight( .1 );
			smooth();
		}

		function loadBrushes(count) {
			const colorHue = random(0, 360);
			for (let i = 0; i < count; i++)
				brushes.push(new Brush());
		}

		const s = 600;
		class Brush {
			constructor () {
				this.pos = createVector( random(0, width), random(0, height) );
				this.color = color(random(0, 360), 60, 60);
				this.death = false;
				this.angle = random(0, TAU);
				this.speed = random(-.5, .5);
				this.width = random( .05, .15 ) * width;
			}
			update () {
				if ( !this.death ) {
					const a = noise(this.pos.x/s, this.pos.y/s) * TAU * s;
					this.pos.x += cos( a ) * this.speed;
					this.pos.y += sin( a ) * this.speed;
					
					const u = p5.Vector.fromAngle( a + PI, this.width );
					this.pos2 = u.add(this.pos);
				}
			}
			display () {
				stroke(this.color);
				line(this.pos.x, this.pos.y, this.pos2.x, this.pos2.y);
			}
			checkMargin () {
				if (this.pos.x < 0 || this.pos.x > window.innerWidth || this.pos.y < 0 || this.pos.y > window.innerHeight) this.death = true;
			}
		}
	</script>

</html>